c Updated relative spectral response (RSR) functions, Andrew Sayerc 05 MAR 2012. andrew.sayer@nasa.govcc Used these files for RSRs:cc NPP_VIIRS_NG_RSR_I1_Effective_Oct2011f_BA.datc NPP_VIIRS_NG_RSR_I2_Effective_Oct2011f_BA.datc NPP_VIIRS_NG_RSR_I3_filtered_Oct2011f_BA_Mod.datc NPP_VIIRS_NG_RSR_I4_filtered_Oct2011f_BA.datc NPP_VIIRS_NG_RSR_I5_filtered_Oct2011f_BA.datc NPP_VIIRS_NG_RSR_M10_filtered_Oct2011f_BA.datc NPP_VIIRS_NG_RSR_M11_filtered_Oct2011f_BA.datc NPP_VIIRS_NG_RSR_M12_filtered_Oct2011f_BA.datc NPP_VIIRS_NG_RSR_M13_filtered_Oct2011f_BA.datc NPP_VIIRS_NG_RSR_M14_filtered_Oct2011f_BA.datc NPP_VIIRS_NG_RSR_M15_filtered_Oct2011f_BA.datc NPP_VIIRS_NG_RSR_M16A_filtered_Oct2011f_BA.datc NPP_VIIRS_NG_RSR_M16B_filtered_Oct2011f_BA.datc NPP_VIIRS_NG_RSR_M1_Fused_Oct2011f_BA.datc NPP_VIIRS_NG_RSR_M2_Fused_Oct2011f_BA.datc NPP_VIIRS_NG_RSR_M3_Fused_Oct2011f_BA.datc NPP_VIIRS_NG_RSR_M4_Fused_Oct2011f_BA.datc NPP_VIIRS_NG_RSR_M5_Fused_Oct2011f_BA.datc NPP_VIIRS_NG_RSR_M6_Fused_Oct2011f_BA.datc NPP_VIIRS_NG_RSR_M7_Fused_Oct2011f_BA.datc NPP_VIIRS_NG_RSR_M8_filtered_Oct2011f_BA.datc NPP_VIIRS_NG_RSR_M9_filtered_Oct2011f_BA.datcc Resampled to 2.5 nm wavelength intervals.c These are the band-averaged Northop Grummanc best pre-launch estimate analysis.cc These have been tested, to an extent, although I do notc claim definitively that they are 100% correct.c So if you find something unusual, it could be an error.c Caveat emptor.c For typical aerosol cases, simulations of TOA reflectancec are typically about 1-3% different from values obtainedc with the old placeholder RSRS, although this is, of course,c dependent on geometry, atmosphere, surface...c      subroutine viirs(iwa)      common /sixs_ffu/ s(1501),wlinf,wlsup      real sr(16,1501),wli(16),wls(16)      real wlinf,wlsup,s      integer iwa,l,ic     BAND M1      data (sr(1,l),l=1,1501)/     a 58*0.0,0.0116,     a 0.142,0.457,0.728,0.822,0.866,     a 0.919,0.997,0.927,1.00,0.717,     a 0.111,0.0401,     a 143*0.0,0.0101,     a 0.0100,     a 5*0.0,0.0124,     a 1279*0.0/c     BAND m2      data (sr(2,l),l=1,1501)/     a 73*0.0,0.0322,     a 0.371,0.758,0.788,0.861,1.00,     a 0.897,0.637,0.224,0.0840,0.0198,     a 1417*0.0/c     BAND m3      data (sr(3,l),l=1,1501)/     a 89*0.0,0.0105,     a 0.121,0.806,0.980,0.966,1.00,     a 0.892,0.904,0.969,0.749,0.168,     a 0.0387,0.0108,     a 1399*0.0/c     BAND m4      data (sr(4,l),l=1,1501)/     a 112*0.0,0.0106,     a 0.0192,0.0406,0.141,0.393,0.804,     a 0.914,0.935,0.989,0.993,1.00,     a 0.935,0.627,0.167,0.0809,0.0387,     a 0.0197,0.0109,     a 1371*0.0/c     BAND m5      data (sr(5,l),l=1,1501)/     a 160*0.0,0.0139,     a 0.0229,0.0450,0.103,0.260,0.563,     a 0.844,0.958,0.968,0.981,1.00,     a 0.919,0.616,0.283,0.115,0.0503,     a 0.0244,0.0132,     a 1323*0.0/c     BAND m6      data (sr(6,l),l=1,1501)/     a 193*0.0,0.0222,     a 0.0725,0.311,0.860,1.00,0.977,     a 0.982,0.899,0.468,0.128,0.0353,     a 0.0122,     a 1296*0.0/c     BAND m7      data (sr(7,l),l=1,1501)/     a 232*0.0,0.0117,     a 0.0217,0.0441,0.0969,0.221,0.467,     a 0.769,0.945,1.00,0.995,0.986,     a 0.976,0.967,0.961,0.962,0.969,     a 0.978,0.981,0.935,0.797,0.577,     a 0.359,0.195,0.105,0.0554,0.0307,     a 0.0179,0.0108,     a 1241*0.0/c     BAND m8      data (sr(8,l),l=1,1501)/     a 385*0.0,0.0144,     a 0.0144,0.0302,0.0688,0.182,0.457,     a 0.857,1.00,0.957,0.944,0.972,     a 0.992,0.988,0.978,0.921,0.701,     a 0.380,0.168,0.0762,0.0362,0.0189,     a 0.0105,     a 1094*0.0/c     BAND m9      data (sr(9,l),l=1,1501)/     a 443*0.0,0.0191,     a 0.0207,0.0196,0.0902,0.404,0.927,     a 0.948,0.980,1.00,0.939,0.531,     a 0.147,0.0347,     a 1045*0.0/c     BAND m10      data (sr(10,l),l=1,1501)/     a 517*0.0,0.0106,     a 0.0142,0.0193,0.0267,0.0378,0.0538,     a 0.0772,0.111,0.160,0.228,0.322,     a 0.438,0.564,0.683,0.781,0.849,     a 0.883,0.892,0.879,0.854,0.840,     a 0.844,0.858,0.879,0.900,0.921,     a 0.937,0.953,0.972,0.990,1.00,     a 0.990,0.939,0.842,0.702,0.548,     a 0.404,0.290,0.205,0.143,0.102,     a 0.0720,0.0524,0.0388,0.0295,0.0228,     a 0.0180,0.0144,0.0117,     a 935*0.0/c     BAND m11      data (sr(11,l),l=1,1501)/     a 785*0.0,0.0113,     a 0.0157,0.0227,0.0339,0.0533,0.0862,     a 0.144,0.242,0.398,0.607,0.816,     a 0.950,0.979,0.954,0.927,0.911,     a 0.915,0.936,0.963,0.989,1.00,     a 0.992,0.953,0.889,0.804,0.710,     a 0.608,0.503,0.397,0.292,0.202,     a 0.131,0.0820,0.0496,0.0304,0.0184,     a 0.0116,     a 679*0.0/c     BAND m12      data (sr(12,l),l=1,1501)/     a 1307*0.0,0.0109,     a 0.0121,0.0136,0.0151,0.0169,0.0191,     a 0.0214,0.0243,0.0273,0.0305,0.0346,     a 0.0388,0.0440,0.0502,0.0566,0.0646,     a 0.0731,0.0823,0.0937,0.105,0.120,     a 0.136,0.154,0.177,0.201,0.228,     a 0.259,0.290,0.327,0.366,0.406,     a 0.448,0.491,0.534,0.574,0.615,     a 0.652,0.687,0.721,0.750,0.778,     a 0.801,0.818,0.835,0.847,0.857,     a 0.867,0.872,0.877,0.880,0.883,     a 0.886,0.890,0.894,0.897,0.902,     a 0.906,0.913,0.920,0.927,0.933,     a 0.939,0.947,0.956,0.964,0.972,     a 0.978,0.984,0.988,0.993,0.996,     a 0.998,0.100,1.00,0.100,0.998,     a 0.995,0.991,0.987,0.984,0.981,     a 0.977,0.972,0.966,0.957,0.948,     a 0.939,0.933,0.927,0.924,0.922,     a 0.922,0.924,0.926,0.926,0.926,     a 0.925,0.918,0.910,0.895,0.872,     a 0.849,0.816,0.781,0.744,0.699,     a 0.654,0.609,0.565,0.520,0.478,     a 0.436,0.396,0.360,0.324,0.293,     a 0.264,0.235,0.212,0.189,0.168,     a 0.151,0.134,0.120,0.108,0.0955,     a 0.0864,0.0776,0.0696,0.0629,0.0564,     a 0.0511,0.0464,0.0419,0.0382,0.0346,     a 0.0315,0.0288,0.0261,0.0239,0.0218,     a 0.0198,0.0182,0.0166,0.0153,0.0141,     a 0.0130,0.0120,0.0110,0.0101,     a 44*0.0/c     BAND i1      data (sr(13,l),l=1,1501)/     a 134*0.0,0.0196,     a 0.0386,0.0763,0.166,0.293,0.530,     a 0.711,0.819,0.841,0.853,0.881,     a 0.892,0.894,0.906,0.918,0.930,     a 0.928,0.928,0.939,0.964,0.994,     a 0.997,0.991,0.974,0.946,0.921,     a 0.912,0.938,0.980,0.999,1.00,     a 0.984,0.972,0.963,0.956,0.954,     a 0.930,0.650,0.370,0.105,0.0329,     a 1326*0.0/c     BAND i2      data (sr(14,l),l=1,1501)/     a 232*0.0,0.0147,     a 0.0286,0.0579,0.127,0.280,0.514,     a 0.760,0.939,0.998,1.00,0.997,     a 0.994,0.990,0.986,0.986,0.988,     a 0.989,0.971,0.906,0.776,0.575,     a 0.361,0.208,0.113,0.0608,0.0329,     a 0.0184,0.0110,     a 1241*0.0/c     BAND i3      data (sr(15,l),l=1,1501)/     a 517*0.0,0.0123,     a 0.0201,0.0284,0.0368,0.0453,0.0691,     a 0.117,0.164,0.212,0.260,0.330,     a 0.453,0.584,0.704,0.789,0.842,     a 0.864,0.859,0.826,0.770,0.734,     a 0.752,0.799,0.841,0.865,0.888,     a 0.920,0.946,0.974,0.990,1.00,     a 0.979,0.910,0.798,0.654,0.502,     a 0.367,0.257,0.181,0.126,0.0885,     a 0.0621,0.0443,0.0326,0.0258,0.0211,     a 0.0172,0.0134,0.0102,     a 935*0.0/c     BAND i4      data (sr(16,l),l=1,1501)/     a 1290*0.0,0.0112,     a 0.0126,0.0143,0.0162,0.0184,0.0209,     a 0.0237,0.0268,0.0304,0.0347,0.0398,     a 0.0459,0.0528,0.0609,0.0700,0.0803,     a 0.0929,0.108,0.124,0.142,0.164,     a 0.187,0.212,0.241,0.273,0.307,     a 0.342,0.381,0.422,0.462,0.502,     a 0.537,0.570,0.599,0.623,0.646,     a 0.671,0.697,0.719,0.736,0.746,     a 0.755,0.766,0.777,0.791,0.803,     a 0.806,0.810,0.816,0.818,0.817,     a 0.818,0.823,0.827,0.830,0.829,     a 0.829,0.830,0.829,0.825,0.825,     a 0.834,0.836,0.834,0.835,0.833,     a 0.824,0.821,0.821,0.822,0.822,     a 0.821,0.817,0.811,0.807,0.803,     a 0.802,0.808,0.817,0.831,0.849,     a 0.865,0.880,0.896,0.914,0.935,     a 0.948,0.948,0.949,0.947,0.939,     a 0.942,0.950,0.957,0.956,0.950,     a 0.950,0.952,0.949,0.942,0.938,     a 0.937,0.933,0.922,0.913,0.900,     a 0.884,0.863,0.843,0.833,0.828,     a 0.829,0.838,0.863,0.896,0.929,     a 0.960,0.988,1.00,0.995,0.989,     a 0.981,0.970,0.961,0.955,0.955,     a 0.958,0.962,0.968,0.965,0.957,     a 0.953,0.952,0.954,0.962,0.969,     a 0.975,0.985,0.991,0.980,0.968,     a 0.968,0.965,0.957,0.951,0.946,     a 0.935,0.919,0.912,0.912,0.906,     a 0.903,0.907,0.910,0.912,0.915,     a 0.924,0.940,0.957,0.970,0.974,     a 0.977,0.984,0.988,0.986,0.982,     a 0.983,0.986,0.993,0.993,0.987,     a 0.980,0.972,0.962,0.951,0.938,     a 0.920,0.887,0.843,0.801,0.757,     a 0.708,0.653,0.597,0.541,0.482,     a 0.425,0.370,0.320,0.279,0.242,     a 0.210,0.182,0.157,0.135,0.117,     a 0.101,0.0871,0.0754,0.0655,0.0571,     a 0.0499,0.0436,0.0380,0.0331,0.0290,     a 0.0254,0.0223,0.0197,0.0175,0.0155/c I bands      wli(13)=0.5800      wls(13)=0.7000      wli(14)=0.8100      wls(14)=0.9200      wli(15)=1.5250      wls(15)=1.7000      wli(16)=3.4000      wls(16)=4.0000c M bands      wli(1)=0.3900      wls(1)=0.4400      wli(2)=0.4200      wls(2)=0.4700      wli(3)=0.4600      wls(3)=0.5200      wli(4)=0.5200      wls(4)=0.6200      wli(5)=0.6300      wls(5)=0.7100      wli(6)=0.7200      wls(6)=0.7700      wli(7)=0.8100      wls(7)=0.9200      wli(8)=1.2100      wls(8)=1.2700      wli(9)=1.3500      wls(9)=1.4000      wli(10)=1.5250      wls(10)=1.7000      wli(11)=2.2200      wls(11)=2.3250      wli(12)=3.4500      wls(12)=3.9500      do 1 i=1,1501      s(i)=sr(iwa,i)    1 continue      wlinf=wli(iwa)      wlsup=wls(iwa)      return      end